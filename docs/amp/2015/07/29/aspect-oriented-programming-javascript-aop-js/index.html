<!DOCTYPE html>
<html ⚡>
  <head>
    <meta charset="utf-8">
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="theme-color" content="#263238">

<meta name="generator" content="Hugo 0.22-DEV" />

<link rel="apple-touch-icon" href="http://blog.mgechev.com/amp/images/logo.png">


<link rel="canonical" href="http://blog.mgechev.com/amp/2015/07/29/aspect-oriented-programming-javascript-aop-js/">


    
    <link href="https://fonts.googleapis.com/css?family=Lobster|Lato:400,700" rel="stylesheet">
    
    <title>Aspect-Oriented Programming in JavaScript - Minko Gechev&#39;s blog</title>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    
    
<meta name="description" content="Note: The following blog post is based on the library aspect.js, which can be found here.The object-oriented programming paradigm is powerful. We design an OO system by decomposition of the problem domain, following guiding principles concerning the decomposition and the communication between the different modules. The process is structured; it involves logical thinking, understanding of the domain and eventual predictions for the future evolution of the system. Often we&amp;rsquo;re trying to keep our code DRY (not always), highly coherent and loosely coupled.">

<meta property="og:title" content="Aspect-Oriented Programming in JavaScript - Minko Gechev&#39;s blog">
<meta property="og:type" content="article">
<meta property="og:url" content="http://blog.mgechev.com/amp/2015/07/29/aspect-oriented-programming-javascript-aop-js/">
<meta property="og:image" content="http://blog.mgechev.com/amp/images/default.png">
<meta property="og:site_name" content="Minko Gechev&#39;s blog">
<meta property="og:description" content="Note: The following blog post is based on the library aspect.js, which can be found here.The object-oriented programming paradigm is powerful. We design an OO system by decomposition of the problem domain, following guiding principles concerning the decomposition and the communication between the different modules. The process is structured; it involves logical thinking, understanding of the domain and eventual predictions for the future evolution of the system. Often we&amp;rsquo;re trying to keep our code DRY (not always), highly coherent and loosely coupled.">
<meta property="og:locale" content="ja_JP">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="Minko Gechev&#39;s blog">
<meta name="twitter:url" content="http://blog.mgechev.com/amp/2015/07/29/aspect-oriented-programming-javascript-aop-js/">
<meta name="twitter:title" content="Aspect-Oriented Programming in JavaScript - Minko Gechev&#39;s blog">
<meta name="twitter:description" content="Note: The following blog post is based on the library aspect.js, which can be found here.The object-oriented programming paradigm is powerful. We design an OO system by decomposition of the problem domain, following guiding principles concerning the decomposition and the communication between the different modules. The process is structured; it involves logical thinking, understanding of the domain and eventual predictions for the future evolution of the system. Often we&amp;rsquo;re trying to keep our code DRY (not always), highly coherent and loosely coupled.">
<meta name="twitter:image" content="http://blog.mgechev.com/amp/images/default.png">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "NewsArticle",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id":"http://blog.mgechev.com/amp/"
    },
    "headline": "Aspect-Oriented Programming in JavaScript - Minko Gechev&#39;s blog",
    "image": {
      "@type": "ImageObject",
      "url": "http://blog.mgechev.com/amp/images/default.png",
      "height": 800,
      "width": 800
    },
    "datePublished": "2015-07-29T00:00:00JST",
    "dateModified": "2015-07-29T00:00:00JST",
    "author": {
      "@type": "Person",
      "name": "Minko Gechev&#39;s blog"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Minko Gechev&#39;s blog",
      "logo": {
        "@type": "ImageObject",
        "url": "http://blog.mgechev.com/amp/images/logo.png",
        "width": 600,
        "height": 60
      }
    },
    "description": "Note: The following blog post is based on the library aspect.js, which can be found here.
The object-oriented programming paradigm is powerful. We design an OO system by decomposition of the problem domain, following guiding principles concerning the decomposition and the communication between the different modules. The process is structured; it involves logical thinking, understanding of the domain and eventual predictions for the future evolution of the system. Often we&rsquo;re trying to keep our code DRY (not always), highly coherent and loosely coupled."
  }
</script>


    <style amp-custom>
      html { font-size: 18px;}@media (max-width: 768px) { html { font-size: 15px; }}body { font-family: Lato,'Hiragino Kaku Gothic Pro',メイリオ,Meiryo,sans-serif; font-size: inherit; margin: 0; color: #263238;}html, body { margin: 0;}a { text-decoration: none; color: #e91e63;}p { margin: 0;}ul,ol { margin: 0; padding: 0;}h1, h2, h3, h4, h5, h6 { margin: 0; font-weight: 700;}h1 { font-size: 1.8rem; line-height: 2rem; margin: 1.5rem 0; }h2 { font-size: 1.4rem; line-height: 2rem; margin: 1.5rem 0; }h3 { font-size: 1.2rem; line-height: 1.5rem; margin: 1.5rem 0; }h4, h5, h6 { font-size: 1rem; line-height: 1.5rem; margin: 1.5rem 0; }.clearfix::after { content: ''; display: block; clear: both;}main { display: block;}/* Layouts */.l-header { padding: .5rem 0; margin-bottom: 2rem; border-bottom: 1px dashed #cfd8dc; text-align: center;}.l-footer { font-size: .8rem; padding: 1rem 0; border-top: 1px dashed #cfd8dc;}.l-container { max-width: 42rem; margin: 0 auto; padding: 0 1rem;}/* Parts:logo */.p-logo { font-family: Lobster, cursive;}.p-logo a { color: #000; font-size: 1.6rem; line-height: 2rem;}/* Parts:section */section { border-top: 2px solid #eceff1; padding: 1.5rem 0;}section>header { text-transform: uppercase; font-weight: 700; margin-bottom: 2rem; text-align: center;}section>header span { display: inline-block; background-color: #000; color: #fff; letter-spacing: 3px; font-size: .7rem; padding: .5rem .75rem;}/* Parts:facts */.p-facts { list-style: none; font-size: .8rem; margin-bottom: 1rem;}.p-facts:last-child { margin-bottom: 0;}.p-facts li { display: inline-block; margin-right: .5rem; text-transform: uppercase;}.p-facts li header { margin-bottom: .25rem; font-weight: 700;}.p-facts li header a { color: #000; text-decoration: underline;}.p-facts li li { display: inline-block; margin-right: .5rem;}.p-facts li li::after { content: ',';}.p-facts li li:last-child::after { content: '';}/* Parts:crumb */.p-crumb { list-style: none; margin-bottom: 1rem; font-size: .8rem; text-transform: uppercase; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.p-crumb:last-child { margin-bottom: 0;}.p-crumb li { display: inline;}.p-crumb li::after { content: '›'; margin: 0 .5rem;}.p-crumb li:last-child::after { content: '';}/* Parts:page-title */.p-page-title { margin-bottom: 2rem;}.p-page-title .title { margin-bottom: .5rem;}/* Parts:share */.p-share { margin-bottom: 1.5rem;}.p-share a { display: inline-block; text-align: center; padding: .5rem .5rem; margin-right: .25rem; font-size: .6rem; background-color: #eceff1; font-weight: 700k}.p-share a.ht { color: #00a4de; }.p-share a.fb { color: #3b5998; }.p-share a.tw { color: #1da1f2; }.p-share a.gp { color: #dd4b39; }.p-share a.ln { color: #00c300; }.p-share a.ht::before { content: 'Hatena'; }.p-share a.fb::before { content: 'Facebook'; }.p-share a.tw::before { content: 'Twitter'; }.p-share a.gp::before { content: 'Google+'; }.p-share a.ln::before { content: 'LINE'; }/* Parts:terms */.p-terms { padding-left: 2rem;}/* Parts:paginator */.p-paginator { text-align: center; margin-bottom: 3rem; padding-top: 2rem;}.p-paginator a { display: inline-block; border: 2px solid #eceff1; color: #263238; line-height: 2rem; padding: 0 1rem;}/* Parts:article */.p-articles { list-style: none;}.p-articles>li { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px dashed #cfd8dc;}.p-articles>li:last-child { border-bottom: none; padding-bottom: 0;}.p-articles.thin>li { margin-bottom: 1rem; padding-bottom: 1rem;}article .article-header { display: table-cell; height: 6rem; vertical-align: middle;}article .title { margin: 0; margin-bottom: .5rem; font-size: 1.4rem; line-height: 2rem;}article .title a { color: #000;}article .header-wrapper { margin-bottom: 1.5rem;}article .thumbnail { display: block; background-position: center; background-size: cover; background-image: url(http://blog.mgechev.com/amp/images/default.jpg); width: 6rem; height: 6rem; border-radius: 50%; box-shadow: 0 0 3px 0 #333 inset; float: left; margin-right: 1rem;}article .summary { margin-bottom: 1.5rem;}article .readmore { text-align: center;}article .readmore a { font-size: .8rem; color: #000; text-decoration: underline;}article.li.sm .header-wrapper { margin-bottom: 0;}.article-body h2 { padding: 1rem 0; border-bottom: 2px solid #eceff1;}.article-body h2:first-child { margin-top: 0; }.article-body h3 { color: #cddc39;}.article-body h4 { border-left: solid .25rem #cddc39; padding: 0 .5rem;}.article-body p { margin: 1.5rem 0; line-height: 1.5rem;}.article-body a { text-decoration: underline;}.article-body ul,.article-body ol { padding-left: 1.5rem;}.article-body code { display: inline-block; font-family: Menlo, consolas, monospace; background-color: #eceff1; font-size: .8rem; padding: 0 .5rem; line-height: 1.5rem;}.article-body pre { margin: 1.5rem 0; padding: 1.5rem; font-size: .8rem; background-color: #263238; color: #fff; overflow: auto;}.article-body pre code { background-color: transparent;}.article-body blockquote { margin: 1.5rem 0; padding: .5rem 0; font-size: .8rem; border-top: 1px solid #eceff1; border-bottom: 1px solid #eceff1; color: #607d8b;}.article-body blockquote p { margin: .5rem 0; line-height: 1rem;}.article-body strong { box-shadow: 0 -.5rem 0 0 #f06292 inset;}.article-body em { font-style: normal; font-weight: 700; color: #ff5722;}.article-body figure { margin: 1.5rem -2rem; }.article-body figure.left,.article-body figure.right { width: 15rem; height: 12rem; margin-top: 0; margin-left: 0; margin-right: 0;}.article-body figure.left { float: left; margin-right: 1rem; margin-left: -2rem; }.article-body figure.right { float: right; margin-left: 1rem; margin-right: -2rem; }@media (max-width: 768px) { .article-body figure { margin: 1.5rem -1rem; } .article-body figure.left, .article-body figure.right { float: none; margin: 0 -1rem; width: auto; height: auto; }}.article-body figcaption { padding: .5rem 0; font-size: .8rem; text-align: center;}.article-body figcaption a { color: #263238;}

      
    </style>
  </head>

  <body>
    
    
    <amp-analytics type="googleanalytics" id="analytics1">
      <script type="application/json">
        {
          "vars": {
            "account": "UA-18060688-3"
          },
          "triggers": {
            "trackPageview": {
              "on": "visible",
              "request": "pageview"
            }
          }
        }
      </script>
    </amp-analytics>
    
    

    <header class="l-header">
      <div class="l-container">
        <div class="h-logo p-logo">
          <a href="http://blog.mgechev.com/amp/" class="h-logo">Minko Gechev&#39;s blog</a>
        </div>
      </div>
    </header>

    <main>
      
<div class="l-container">
  <article class="single article-bcb27a3cfd3d86827293c1dcf5de243e">
  <div class="header-wrapper">
    <a href="http://blog.mgechev.com/amp/2015/07/29/aspect-oriented-programming-javascript-aop-js/" class="thumbnail" title="Aspect-Oriented Programming in JavaScript"></a>
    <header class="article-header">
      <div class="clearfix">
        <h1 class="title">Aspect-Oriented Programming in JavaScript</h1>
        <ul class="p-facts">
          <li><time datetime="2015-07-29T00:00:00JST">Jul 29, 2015</time></li>
          <li><a href="http://blog.mgechev.com/amp/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>

  <aside class="p-share">
  <a href="http://b.hatena.ne.jp/add?mode=confirm&url=http%3a%2f%2fblog.mgechev.com%2famp%2f2015%2f07%2f29%2faspect-oriented-programming-javascript-aop-js%2f&title=Aspect-Oriented%20Programming%20in%20JavaScript" title="はてなブックマーク" class="ht" target="_blank" rel="nofollow"></a>
  <a href="http://www.facebook.com/sharer.php?u=http%3a%2f%2fblog.mgechev.com%2famp%2f2015%2f07%2f29%2faspect-oriented-programming-javascript-aop-js%2f&t=Aspect-Oriented%20Programming%20in%20JavaScript" title="Facebookでシェア" class="fb" target="_blank" rel="nofollow"></a>
  <a href="http://twitter.com/intent/tweet?url=http%3a%2f%2fblog.mgechev.com%2famp%2f2015%2f07%2f29%2faspect-oriented-programming-javascript-aop-js%2f&text=Aspect-Oriented%20Programming%20in%20JavaScript&tw_p=tweetbutton" title="Twitterでシェア" class="tw" target="_blank" rel="nofollow"></a>
  <a href="https://plus.google.com/share?url=http%3a%2f%2fblog.mgechev.com%2famp%2f2015%2f07%2f29%2faspect-oriented-programming-javascript-aop-js%2f" title="Google Plusでシェア" class="gp" target="_blank" rel="nofollow"></a>
  <a href="http://line.me/R/msg/text/?Aspect-Oriented%20Programming%20in%20JavaScript http%3a%2f%2fblog.mgechev.com%2famp%2f2015%2f07%2f29%2faspect-oriented-programming-javascript-aop-js%2f" title="LINEでシェア" class="ln" target="_blank" rel="nofollow"></a>
</aside>


  <div class="article-body">

<p><em>Note: The following blog post is based on the library <a href="(https://github.com/mgechev/aspect.js)">aspect.js</a>, which can be <a href="https://github.com/mgechev/aspect.js">found here</a>.</em></p>

<p>The object-oriented programming paradigm is powerful. We design an OO system by decomposition of the problem domain, following guiding principles concerning the decomposition and the communication between the different modules. The process is structured; it involves logical thinking, understanding of the domain and eventual predictions for the future evolution of the system. Often we&rsquo;re trying to keep our code DRY (<a href="https://twitter.com/BonzoESC/status/442003113910603776/photo/1">not always</a>), highly coherent and loosely coupled. However, in some cases this is just impossible. There are some code snippets we&rsquo;re just blindly copying and pasting all around our code base.</p>

<h2 id="cross-cutting-concerns">Cross-cutting Concerns</h2>

<p>Lets say we have ES2015 class, which implements client-side <a href="https://en.wikipedia.org/wiki/Active_record_pattern">active record</a>:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="kr">class</span> <span class="nx">ArticleCollection</span> <span class="p">{</span>
  <span class="nx">getArticleById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/articles/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>
      <span class="p">});</span>
  <span class="p">}</span>
  <span class="nx">getArticles</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/articles&#39;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">removeArticleById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/articles/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;delete&#39;</span>
      <span class="p">});</span>
  <span class="p">}</span>
  <span class="nx">updateArticle</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">article</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/articles/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;put&#39;</span>
      <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>We define the class <code>ArticleCollection</code>, which provides methods for fetching new articles, removing and updating already existing ones. In a typical scenario, during our development process we may want to add logging when given method is called and when its execution is completed:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="kr">class</span> <span class="nx">ArticleCollection</span> <span class="p">{</span>
  <span class="nx">getArticleById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Invoked getArticleById with arguments: </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/articles/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">article</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;The invocation of getArticleById completed succssfully&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">article</span><span class="p">;</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Error during the invocation of getArticleById&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
      <span class="p">});</span>
  <span class="p">}</span>
  <span class="nx">getArticles</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Invoked getArticles with no arguments&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/articles&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;The invocation of getArticles completed succssfully&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Error during the invocation of getArticles&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
      <span class="p">});</span>
  <span class="p">}</span>
  <span class="nx">removeArticleById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Invoked removeArticleById with arguments: </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/articles/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;delete&#39;</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;The invocation of removeArticleById completed succssfully&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Error during the invocation of removeArticleById&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
      <span class="p">});</span>
  <span class="p">}</span>
  <span class="nx">updateArticle</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">article</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Invoked updateArticle with arguments: </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">article</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/articles/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;put&#39;</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;The invocation of updateArticle completed succssfully&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Error during the invocation of updateArticle&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
      <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Cool&hellip;looks quite messy? How about having 20 more similar domain classes where we need to have the same logging logic? Lets look at the snippets and find some patterns:</p>

<ul>
<li>In the beginning of the method&rsquo;s invocation we log message in the format: <code>Invoked METHOD_NAME with arguments: ARG1, ARG2, ..., ARG3</code>.</li>
<li>On success we log: <code>The invocation of METHOD_NAME completed successfully</code></li>
<li>On error we log: <code>Error during the invocation of METHOD_NAME</code></li>
</ul>

<p>What can we do in order to modularize these duplications? Create decorator of the class? Yeah, probably it is going to work. However, there&rsquo;s more elegant way to deal with this. Lets say, we define something called <code>LoggerAspect</code> and take advantage of the <a href="https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841">ES2016 decorators declarative</a> syntax:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="kr">class</span> <span class="nx">LoggerAspect</span> <span class="p">{</span>
  <span class="err">@</span><span class="nx">beforeMethod</span><span class="p">({</span>
    <span class="nx">methodNamePattern</span><span class="o">:</span> <span class="sr">/.*/</span><span class="p">,</span>
    <span class="nx">classNamePattern</span><span class="o">:</span> <span class="sr">/Article/</span>
  <span class="p">})</span>
  <span class="nx">beforeLogger</span><span class="p">(</span><span class="nx">meta</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Invoked </span><span class="si">${</span><span class="nx">meta</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> with arguments: </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="err">@</span><span class="nx">afterResolve</span><span class="p">({</span>
    <span class="nx">methodNamePattern</span><span class="o">:</span> <span class="sr">/.*/</span><span class="p">,</span>
    <span class="nx">classNamePattern</span><span class="o">:</span> <span class="sr">/Article/</span>
  <span class="p">})</span>
  <span class="nx">afterResolveLogger</span><span class="p">(</span><span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`The invocation of </span><span class="si">${</span><span class="nx">meta</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="err">@</span><span class="nx">afterReject</span><span class="p">({</span>
    <span class="nx">methodNamePattern</span><span class="o">:</span> <span class="sr">/.*/</span><span class="p">,</span>
    <span class="nx">classNamePattern</span><span class="o">:</span> <span class="sr">/Article/</span>
  <span class="p">})</span>
  <span class="nx">afterRejectLogger</span><span class="p">(</span><span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Error during the invocation of </span><span class="si">${</span><span class="nx">meta</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Lets translate this step-by-step to human language:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="c1">// ...</span>
<span class="err">@</span><span class="nx">before</span><span class="p">({</span>
  <span class="nx">methodNamePattern</span><span class="o">:</span> <span class="sr">/.*/</span><span class="p">,</span>
  <span class="nx">classNamePattern</span><span class="o">:</span> <span class="sr">/Article/</span>
<span class="p">})</span>
<span class="nx">beforeLogger</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Invoked </span><span class="si">${</span><span class="nx">meta</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb"> with arguments: </span><span class="si">${</span><span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// ...</span>
</code></pre></div>

<ul>
<li>Before the execution of all methods, which names match the regular expression <code>/Article/</code> defined inside classes, which names match the regular expression: <code>/.*/</code> - invoke the <code>beforeLogger</code> method&rsquo;s body. So, this definition is going to wrap all matched methods inside a function, which will call <code>beforeLogger</code> and after that will invoke the target method.</li>
</ul>

<p>How about this:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="err">@</span><span class="nx">afterResolve</span><span class="p">({</span>
  <span class="nx">methodNamePattern</span><span class="o">:</span> <span class="sr">/.*/</span><span class="p">,</span>
  <span class="nx">classNamePattern</span><span class="o">:</span> <span class="sr">/Article/</span>
<span class="p">})</span>
<span class="nx">afterResolveLogger</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`The invocation of </span><span class="si">${</span><span class="nx">meta</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<ul>
<li>After the resolution of promise returned any method, which name matches the regular expression <code>/Article/</code>, defined within class, which name matches the regular expression <code>/.*/</code> invoke the body of <code>afterResolveLogger</code>. This means that for all matched methods will be created a wrapper, which invokes the method and on resolve of the returned promise calls the <code>afterResolveLogger</code>.</li>
</ul>

<p>Okay, sounds good&hellip;How about <code>afterReject</code>?</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="err">@</span><span class="nx">afterReject</span><span class="p">({</span>
  <span class="nx">methodNamePattern</span><span class="o">:</span> <span class="sr">/.*/</span><span class="p">,</span>
  <span class="nx">classNamePattern</span><span class="o">:</span> <span class="sr">/Article/</span>
<span class="p">})</span>
<span class="nx">afterRejectLogger</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Error during the invocation of </span><span class="si">${</span><span class="nx">meta</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<ul>
<li>After the rejection of promise returned any method, which name matches the regular expression <code>/Article/</code>, defined within class, which name matches the regular expression <code>/.*/</code> invoke the body of <code>afterRejectLogger</code>. This means that for all matched methods will be created a wrapper, which invokes the method and on reject of the returned promise calls the <code>afterResolveLogger</code>.</li>
</ul>

<p>How we can apply this &ldquo;aspect&rdquo; to our <code>ArticleCollection</code>?</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="err">@</span><span class="nx">Wove</span>
<span class="kr">class</span> <span class="nx">ArticleCollection</span> <span class="p">{</span>
  <span class="nx">getArticleById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/articles/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>
      <span class="p">});</span>
  <span class="p">}</span>
  <span class="nx">getArticles</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/articles&#39;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">removeArticleById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/articles/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;delete&#39;</span>
      <span class="p">});</span>
  <span class="p">}</span>
  <span class="nx">updateArticle</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">article</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`/articles/</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;put&#39;</span>
      <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>That&rsquo;s it. We replaced all the 56 lines of the <code>ArticleCollection</code> definition with the 20 lines definition by taking advantage of the module called <code>LoggerAspect</code>. However, the lack of code duplications here is not our biggest win. We were able to isolate the logging code into separate module, called aspect. The same strategy is applicable in many different scenarios:</p>

<ul>
<li>Transactions</li>
<li>Authorization</li>
<li>Formatting data</li>
<li>Attaching observers</li>
<li>etc.</li>
</ul>

<h2 id="video">Video</h2>

<p>Here&rsquo;s video from my talk on AngularConnect where I did an overview of the library above:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/C6e6-31HD5A" frameborder="0" allowfullscreen></iframe>

<h2 id="conclusions">Conclusions</h2>

<p>The post illustrated a typical use case for Aspect-Oriented Programming. In the past there were a few libraries implementing proxy-based AOP in JavaScript, however the syntax wasn&rsquo;t getting even close to already known solutions (for example the AOP implementation in Spring). ES2016 introduced the decorators syntax, which is in the core of the Dependency Injection of Angular 2. It is here to stay and implementing AOP with it is quite handy.</p>

<h3 id="future-development">Future Development</h3>

<p>The examples above are based on a library I developed, called <a href="https://github.com/mgechev/aspect.js"><code>aspect.js</code></a>. It is still under active development, so a lot of changes are going to be introduced. You can play with the framework using the instructions in the project&rsquo;s <a href="https://github.com/mgechev/aspect.js/blob/master/README.md#demo">README</a>. For comments and recommendations you can use the <a href="https://github.com/mgechev/aspect.js/issues">GitHub issue tracker of the project</a> or the comment section below.</p>
</div>

  <aside class="p-share">
  <a href="http://b.hatena.ne.jp/add?mode=confirm&url=http%3a%2f%2fblog.mgechev.com%2famp%2f2015%2f07%2f29%2faspect-oriented-programming-javascript-aop-js%2f&title=Aspect-Oriented%20Programming%20in%20JavaScript" title="はてなブックマーク" class="ht" target="_blank" rel="nofollow"></a>
  <a href="http://www.facebook.com/sharer.php?u=http%3a%2f%2fblog.mgechev.com%2famp%2f2015%2f07%2f29%2faspect-oriented-programming-javascript-aop-js%2f&t=Aspect-Oriented%20Programming%20in%20JavaScript" title="Facebookでシェア" class="fb" target="_blank" rel="nofollow"></a>
  <a href="http://twitter.com/intent/tweet?url=http%3a%2f%2fblog.mgechev.com%2famp%2f2015%2f07%2f29%2faspect-oriented-programming-javascript-aop-js%2f&text=Aspect-Oriented%20Programming%20in%20JavaScript&tw_p=tweetbutton" title="Twitterでシェア" class="tw" target="_blank" rel="nofollow"></a>
  <a href="https://plus.google.com/share?url=http%3a%2f%2fblog.mgechev.com%2famp%2f2015%2f07%2f29%2faspect-oriented-programming-javascript-aop-js%2f" title="Google Plusでシェア" class="gp" target="_blank" rel="nofollow"></a>
  <a href="http://line.me/R/msg/text/?Aspect-Oriented%20Programming%20in%20JavaScript http%3a%2f%2fblog.mgechev.com%2famp%2f2015%2f07%2f29%2faspect-oriented-programming-javascript-aop-js%2f" title="LINEでシェア" class="ln" target="_blank" rel="nofollow"></a>
</aside>


  <footer class="article-footer">
    <section>
      <ol class="p-crumb">
        <li><a href="http://blog.mgechev.com/amp/">Minko Gechev&#39;s blog</a></li>
        
        <li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="http://blog.mgechev.com/amp/post/" itemprop="url"><span itemprop="title">post</span></a></li>
        
        <li>Aspect-Oriented Programming in JavaScript</li>
      </ol>

      
      
      
      <ul class="p-facts">
        <li>
          <header><a href="http://blog.mgechev.com/amp/categories/">categories</a></header>
          <ul>
            
            <li><a href="http://blog.mgechev.com/amp/categories/JavaScript/">JavaScript</a></li>
            
            <li><a href="http://blog.mgechev.com/amp/categories/AOP/">AOP</a></li>
            
            <li><a href="http://blog.mgechev.com/amp/categories/OOP/">OOP</a></li>
            
          </ul>
        </li>
      </ul>
      
      
      
      <ul class="p-facts">
        <li>
          <header><a href="http://blog.mgechev.com/amp/tags/">tags</a></header>
          <ul>
            
            <li><a href="http://blog.mgechev.com/amp/tags/JavaScript/">JavaScript</a></li>
            
            <li><a href="http://blog.mgechev.com/amp/tags/AOP/">AOP</a></li>
            
            <li><a href="http://blog.mgechev.com/amp/tags/OOP/">OOP</a></li>
            
            <li><a href="http://blog.mgechev.com/amp/tags/Aspects/">Aspects</a></li>
            
          </ul>
        </li>
      </ul>
      
      
    </section>
  </footer>
</article>



  
  
  <section>
    <header><span>Latests</span></header>
    <ul class="p-articles thin">
      <li><article class="li sm article-43672564696ee352fbf3cd0b906f1e8b">
  <div class="header-wrapper">
    <a href="http://blog.mgechev.com/amp/2018/01/18/react-typescript-redux-immutable/" class="thumbnail" title="3 Tricks For Using Redux and Immutable.js with TypeScript"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="http://blog.mgechev.com/amp/2018/01/18/react-typescript-redux-immutable/">3 Tricks For Using Redux and Immutable.js with TypeScript</a></h2>
        <ul class="p-facts">
          <li><time datetime="2018-01-18T00:00:00JST">Jan 18, 2018</time></li>
          <li><a href="http://blog.mgechev.com/amp/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-6a8d6cd1d272696bfc05f90632f00f22">
  <div class="header-wrapper">
    <a href="http://blog.mgechev.com/amp/2017/12/28/career-development-open-source-get-started/" class="thumbnail" title="Follow Your Dream Career with Open Source. Personal Story."></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="http://blog.mgechev.com/amp/2017/12/28/career-development-open-source-get-started/">Follow Your Dream Career with Open Source. Personal Story.</a></h2>
        <ul class="p-facts">
          <li><time datetime="2017-12-28T00:00:00JST">Dec 28, 2017</time></li>
          <li><a href="http://blog.mgechev.com/amp/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-6462257f7dffe7a4f4bc80054188e5d5">
  <div class="header-wrapper">
    <a href="http://blog.mgechev.com/amp/2017/12/07/redux-anti-patterns-race-conditions-state-management-duplication/" class="thumbnail" title="Redux Anti-Patterns - Part 1. State Management."></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="http://blog.mgechev.com/amp/2017/12/07/redux-anti-patterns-race-conditions-state-management-duplication/">Redux Anti-Patterns - Part 1. State Management.</a></h2>
        <ul class="p-facts">
          <li><time datetime="2017-12-07T00:00:00JST">Dec 7, 2017</time></li>
          <li><a href="http://blog.mgechev.com/amp/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li>
    </ul>
  </section>
  
</div>


    </main>

    

    <footer class="l-footer">
      <div class="l-container">
        <p><span class="h-logo">&copy; Minko Gechev&#39;s blog</span></p>
        <aside>
          <p>Powered by <a href="https://gohugo.io/">Hugo</a>.</p>
          <p><a href="https://github.com/dim0627/hugo_theme_aglaus" class="h-logo">Aglaus</a> designed by <a href="http://yet.unresolved.xyz/">Daisuke Tsuji</a>.</p>
        </aside>
      </div>
    </footer>

    <a href="#" class="p-movetop" title="ページ上部へ戻る" rel="nofollow"></a>
  </body>
</html>

